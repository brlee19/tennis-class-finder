function qAddWin(a){mb.popup(a,"qAddWindow",190,320)}function echeck(a){var b="@",c=".",d=a.indexOf(b),e=a.length;a.indexOf(c);return-1!=a.indexOf(b)&&(-1!=a.indexOf(b)&&0!=a.indexOf(b)&&a.indexOf(b)!=e&&(-1!=a.indexOf(c)&&0!=a.indexOf(c)&&a.indexOf(c)!=e&&(-1==a.indexOf(b,d+1)&&(a.substring(d-1,d)!=c&&a.substring(d+1,d+2)!=c&&(-1!=a.indexOf(c,d+2)&&(-1==a.indexOf(" ")&&e-a.lastIndexOf(".")!=1))))))}function checkrequired(a){return checkRequiredPrefix(a,"required")}function trim(a){if(null!=a)return a.replace(/^\s+|\s+$/g,"")}function checkRequiredPrefix(a,b){var c="",d="";if(firstRadio=!0,secondRadio=!0,firstFocus=!1,document.images){for(i=0;i<a.length;i++){var e=a.elements[i];if(null!=e.name&&e.name.substring(0,b.length)==b){if(("text"==e.type||"password"==e.type||"email"==e.type)&&""==trim(e.value))if("Email"==(c=e.name.substring(b.length+3))){var f=!1;for(j=0;j<a.length;j++){var g=a.elements[j];"optRefusedEmail"==g.name&&(f=g.checked)}f||(d+=SystemMessagesErrorsPagePhrases.PleaseEnterTheError().replace("<ERROR>",c)+"\n",d=d.replace("_"," "),firstFocus||(firstFocus=!0,e.focus()))}else d+=SystemMessagesErrorsPagePhrases.PleaseEnterTheError().replace("<ERROR>",c)+"\n",d=d.replace("_"," "),firstFocus||(firstFocus=!0,e.focus());"opt"!=e.name.substring(b.length,b.length+3)||"0"!=$(e).val()&&""!=$(e).val()||(c=window.implementationSwitchIsEnabled("DCA_ClientIndexCopy")&&$(e).hasClass("js-customClientIndexValidation")?$(e).data("clientindex"):e.name.substring(b.length+3),d+=SystemMessagesErrorsPagePhrases.PleaseSelectTheError().replace("<ERROR>",c)+"\n",firstFocus||(firstFocus=!0,e.focus())),"requiredtxtPassword_Confirmation"==e.name&&a.requiredtxtPassword.value!=a.requiredtxtPassword_Confirmation.value&&(d+=SystemMessagesErrorsPagePhrases.PasswordsDoNotMatch()+"\n",firstFocus||(firstFocus=!0,e.focus())),"requiredtxtZip_Code"==e.name&&a.requiredtxtZip_Code.value.length<4&&(d+=SystemMessagesErrorsPagePhrases.ZipPostalTooShort()+"\n",firstFocus||(firstFocus=!0,e.focus())),"requiredOptMale"==e.name&&"male"==e.value&&0==e.checked&&(firstRadio=!1),"requiredOptMale"==e.name&&"female"==e.value&&0==e.checked&&(secondRadio=!1),0==firstRadio&&0==secondRadio&&(d+=SystemMessagesErrorsPagePhrases.PleaseSelectTheGender()+"\n",firstRadio=!0,secondRadio=!0),"requiredtxtEmail_Address"==e.name&&0==echeck(e.value)&&(d+=SystemMessagesErrorsPagePhrases.InvalidEmailAddress()+"\n",firstFocus||(firstFocus=!0,e.focus()))}}if(""!=d)return d=d.replace("_"," "),alert(d),!1}return!0}function validatePasswordValue(a){var b="";return a.indexOf(" ")>-1&&(b+="Passwords cannot include a space.\n"),a.match(/\d/)||(b+="Passwords must include at least one number.\n"),a.match(/[A-Z]/)||a.match(/[a-z]/)||(b+="Passwords must include at least one letter.\n"),a.length>=8||(b+="Passwords must be at least 8 characters long.\n"),b}function validatePwd(a,b){var c="";return pwdField=document.getElementById(a),pwdValue=pwdField.value,pwdValue.indexOf(" ")>-1&&(c+="Passwords cannot include a space.\n"),pwdValue.match(/\d/)||(c+="Passwords must include at least one number.\n"),pwdValue.match(/[A-Z]/)||pwdValue.match(/[a-z]/)||(c+="Passwords must include at least one letter.\n"),b?pwdValue.length>=8||(c+="Business Mode Passwords must be at least 8 characters long.\n"):pwdValue.length>=8||(c+="Passwords must be at least 8 characters long.\n"),""==c||(alert(c),pwdField.focus(),!1)}function parseDL(a,b,c,d,e,f,g,h){var i="",j="",k="",l="",m="",n="",o="",p=!1;tmpFirstCarrot=0,tmpPos=0,tmpPos2=0,noCityCarat=!1,null!=a&&a.length>30&&(i=a.substring(1,3),"MN"==i?parseMNDL(a,b,c,d,e,f,g,h):(tmpPos=a.indexOf("^",tmpPos),tmpPos>15&&(tmpPos=16,noCityCarat=!0),j=a.substring(3,tmpPos),tmpPos2=a.indexOf("$",tmpPos),","==a.charAt(tmpPos2-1)?(p=!0,l="^"==a.charAt(tmpPos)?a.substring(tmpPos+1,tmpPos2-1).toLowerCase():a.substring(tmpPos,tmpPos2-1).toLowerCase()):l="^"==a.charAt(tmpPos)?a.substring(tmpPos+1,tmpPos2).toLowerCase():a.substring(tmpPos,tmpPos2).toLowerCase(),l=l.charAt(0).toUpperCase()+l.substring(1,l.length),p?tmpPos=a.indexOf(",",tmpPos2+1):-1!=a.indexOf("$",tmpPos2+1)?tmpPos=a.indexOf("$",tmpPos2+1):tmpPos=a.indexOf("^",tmpPos+1),m=a.substring(tmpPos2+1,tmpPos).toLowerCase(),m=m.charAt(0).toUpperCase()+m.substring(1,m.length),tmpFirstCarrot=a.indexOf("^",tmpFirstCarrot),tmpPos=a.indexOf("^",tmpFirstCarrot+1),-1!=a.indexOf("^",tmpPos+1)?tmpPos2=a.indexOf("^",tmpPos+1):noCityCarat?(tmpPos=tmpFirstCarrot,tmpPos2=a.indexOf("^",tmpFirstCarrot+1)):(p=!0,tmpPos2=a.indexOf(",",tmpPos+1)),k=a.substring(tmpPos+1,tmpPos2),tmpPos=a.indexOf("=",tmpPos2+1),o=a.substring(tmpPos-7,tmpPos),n=p?a.substring(tmpPos+10,tmpPos+11)+"/"+a.substring(tmpPos+12,tmpPos+13)+"/"+a.substring(tmpPos+5,tmpPos+9):a.substring(tmpPos+3,tmpPos+5)+"/"+a.substring(tmpPos+11,tmpPos+13)+"/"+a.substring(tmpPos+5,tmpPos+9),null!=b&&(b.value=o),null!=g&&(g.value=m),null!=h&&(h.value=l),null!=e&&(e.value=k),null!=d&&(d.value=j),null!=f&&(f.value=n),null!=c&&(c.value=i)))}function parseMNDL(a,b,c,d,e,f,g,h){var i="MN",j="",k="",l="",m="",n="",o="";cityEndPos=0,nameEndPos=0,tmpPos2=0;var p="";cityEndPos=a.indexOf("^",3),cityEndPos>15&&(cityEndPos=16),j=a.substring(3,cityEndPos),nameEndPos=a.indexOf("^",cityEndPos+1),p=a.substring(cityEndPos,nameEndPos),firstNameEndPos=p.indexOf(" "),m=p.substring(1,firstNameEndPos).toLowerCase(),m=m.charAt(0).toUpperCase()+m.substring(1,m.length),middleNameEndPos=p.indexOf(" ",firstNameEndPos+1),l=p.substring(middleNameEndPos+1,p.length).toLowerCase(),l=l.charAt(0).toUpperCase()+l.substring(1,l.length),addressEndPos=a.indexOf("^",nameEndPos+1),k=a.substring(nameEndPos+1,addressEndPos),licenceEndPos=a.indexOf("=",addressEndPos),o=a.substring(licenceEndPos-7,licenceEndPos),n=a.substring(licenceEndPos+3,licenceEndPos+5)+"/"+a.substring(licenceEndPos+11,licenceEndPos+13)+"/"+a.substring(licenceEndPos+5,licenceEndPos+9),null!=b&&(b.value=o),null!=g&&(g.value=m),null!=h&&(h.value=l),null!=e&&(e.value=k),null!=d&&(d.value=j),null!=f&&(f.value=n),null!=c&&(c.value=i)}function capitaliseFirstLetter(a){document.write(a.charAt(0).toUpperCase()+a.slice(1).toLowerCase())}var SystemMessagesErrorsPagePhrases={PleaseEnterTheError:function(){return"Please enter the <ERROR> \n"},PleaseSelectTheError:function(){return"Please select the <ERROR> \n"},PasswordsDoNotMatch:function(){return"The passwords entered do not match.  Please try again.\n"},ZipPostalTooShort:function(){return"The zip/postal code is too short\n"},PleaseSelectTheGender:function(){return"Please select the Gender\n"},InvalidEmailAddress:function(){return"Invalid Email Address\n"}};