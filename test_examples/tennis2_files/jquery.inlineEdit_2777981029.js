$.fn.inlineEdit=function(){var a={onStartEditing:function(){},onSave:function(){throw'You must implement the "onSave" method when you use $.inlineEdit()'},emptyText:void 0,useTextarea:!0,autoResize:!0,spellCheckOn:!0,debugStyles:!1},b={switchElementToEditMode:function(){function b(){var a=parseInt(d.css("line-height"),10)||14;return $.browser.mozilla?{"margin-left":-1,width:5,extraAutoResizeSpace:0}:$.browser.msie?{"margin-left":0,width:3,extraAutoResizeSpace:a}:$.browser.webkit?{"margin-left":0,width:0,extraAutoResizeSpace:a}:{"margin-left":0,width:0,extraAutoResizeSpace:-1}}var c,d=$(this),e=d.data("inlineEditSettings");c=a.spellCheck?$("<"+(e.useTextarea?"textarea":'input type="text"')+" class='inlineEditInput' />"):$("<"+(e.useTextarea?"textarea":'input type="text"')+" class='inlineEditInput' spellcheck='false' />");var f=d.text();d.text()==e.emptyText&&(f="");var g=e.useTextarea?"relative":"absolute",h={resize:"none",padding:"0 2px 1px 2px","line-height":d.css("line-height"),height:d.height()+"px",overflow:"hidden",position:g,zIndex:2,"margin-top":"-1px","margin-left":-3+b()["margin-left"]+"px",border:"1px solid #999"};e.useTextarea?$.extend(h,{width:d.width()+b().width+"px"}):$.extend(h,{}),c.val(f).data("mySourceElement",d).data("previewMode",!0).insertBefore(d).show().css(h),e.autoResize&&c.autoResize({extraSpace:b().extraAutoResizeSpace,onResize:function(){$(window).resize()},animate:!1,limit:0}),d.data("myTextAreaElement",c),e.useTextarea&&d.hide()},switchElementBackToNormal:function(){var a=$(this),b=a.data("myTextAreaElement"),c=a.data("inlineEditSettings");""==b.val()?a.html(c.emptyText.italics()).text():a.text(b.val()),a.show(),b.siblings(".autoResizeClone").remove(),b.remove()},addClickCatcher:function(){function a(){c.css({height:$(window).height(),width:$(window).width()})}var b=$(this),c=$("<div class='clickCatcher'/>"),d=b.data("myTextAreaElement");a(),$(window).bind("resize.clickCatcher",a),c.data("myTextAreaElement",d).css({position:"fixed",top:0,left:0,zIndex:1}).click(function(){$(this).data("myTextAreaElement").trigger("focusout")}).insertAfter(b),b.data("myClickCatcher",c)},removeClickCatcher:function(){var a=$(this),b=a.data("myClickCatcher");$(window).unbind(".clickCatcher"),b.remove()}},c={textMouseover:function(){function a(b){$(b.target).is(":not(.inlineEditInput)")&&$(".inlineEditInput").trigger("mouseout"),$(document).unbind("mousemove",a)}var c=$(this);$(".inlineEditInput").remove(),b.switchElementToEditMode.call(c),setTimeout(function(){$(document).bind("mousemove",a)},0)},textareaClick:function(a){var c=$(this);if(c.data("previewMode")){c.data("previewMode",!1),c.triggerHandler("change");var d=c.data("mySourceElement"),e=d.data("inlineEditSettings");b.addClickCatcher.call(d),e.onStartEditing.call(d,a)}},textareaMouseout:function(){var a=$(this),c=a.data("mySourceElement");a.data("previewMode")&&b.switchElementBackToNormal.call(c)},textareaFocusout:function(a){var c=$(this),d=c.data("mySourceElement");if(d&&0!=d.length){var e,f=d.data("inlineEditSettings"),g=d.text();d.text()==f.emptyText&&(g=""),e=$.browser.msie?c.val().replace(/\r/g,"\n")!=g.replace(/\r/g,"\n"):c.val()!=g,b.switchElementBackToNormal.call(d),b.removeClickCatcher.call(d),e&&f.onSave.call(d)}}};return function(b){return settings=$.extend({},a,b),this.each(function(){var a=$(this);a.data("inlineEditSettings",settings),a.mousemove(c.textMouseover);var b=a.parent();b.delegate(".inlineEditInput","click",c.textareaClick),settings.debugStyles||(b.delegate(".inlineEditInput","mouseout",c.textareaMouseout),b.delegate(".inlineEditInput","focusout",c.textareaFocusout))})}}();