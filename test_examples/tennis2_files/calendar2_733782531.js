function f_tcalParseDate(a){var b=/^\s*(\d{1,2})\/(\d{1,2})\/(\d{2,4})\s*$/;if("Set"==a.substring(0,3)||"Present"==a.substring(0,7)||"Today"==a.substring(0,5)){var c=new Date;a=c.getMonth()+1+"/"+c.getDate()+"/"+c.getFullYear()}if(!b.exec(a))return alert("Invalid date: '"+a+"'.\nAccepted format is mm/dd/yyyy");var d=Number(RegExp.$2),e=Number(RegExp.$1),f=Number(RegExp.$3);if(f<100&&(f+=f<this.a_tpl.centyear?2e3:1900),e<1||e>12)return alert("Invalid month value: '"+e+"'.\nAllowed range is 01-12.");var g=new Date(f,e,0);return d>g.getDate()?alert("Invalid day of month value: '"+d+"'.\nAllowed range for selected month is 01 - "+g.getDate()+"."):new Date(f,e-1,d)}function f_tcalGenerDate(a){return(a.getMonth()<9?"0":"")+(a.getMonth()+1)+"/"+(a.getDate()<10?"0":"")+a.getDate()+"/"+a.getFullYear()}function tcal(a,b){b||(b=A_TCALDEF),window.A_TCALS||(window.A_TCALS=[]),window.A_TCALSIDX||(window.A_TCALSIDX=[]),this.s_id=a.id?a.id:A_TCALS.length,window.A_TCALS[this.s_id]=this,window.A_TCALSIDX[window.A_TCALSIDX.length]=this,this.f_show=f_tcalShow,this.f_hide=f_tcalHide,this.f_toggle=f_tcalToggle,this.f_update=f_tcalUpdate,this.f_relDate=f_tcalRelDate,this.f_parseDate=f_tcalParseDate,this.f_generDate=f_tcalGenerDate,this.s_iconId="tcalico_"+this.s_id,this.e_icon=f_getElement(this.s_iconId),this.e_icon||(document.write('<img src="'+b.imgpath+'calendar-20px.png" width="23" height="22" id="'+this.s_iconId+'" onclick="A_TCALS[\''+this.s_id+'\'].f_toggle()" class="tcalIcon" alt="Open Calendar" />'),this.e_icon=f_getElement(this.s_iconId)),this.a_cfg=a,this.a_tpl=b}function f_tcalShow(a){if(!this.a_cfg.controlname)throw"TC: control name is not specified";if(this.a_cfg.formname){var b=document.forms[this.a_cfg.formname];if(!b)throw"TC: form '"+this.a_cfg.formname+"' can not be found";this.e_input=b.elements[this.a_cfg.controlname]}else this.e_input=f_getElement(this.a_cfg.controlname);if(!this.e_input||!this.e_input.tagName||"INPUT"!=this.e_input.tagName)throw"TC: element '"+this.a_cfg.controlname+"' does not exist in "+(this.a_cfg.formname?"form '"+this.a_cfg.controlname+"'":"this document");this.e_div=f_getElement("tcal"),this.e_div||(this.e_div=document.createElement("DIV"),this.e_div.id="tcal",$(this.e_icon).offsetParent().append($(this.e_div))),this.e_shade=f_getElement("tcalShade"),this.e_shade||(this.e_shade=document.createElement("DIV"),this.e_shade.id="tcalShade",$(this.e_icon).offsetParent().append($(this.e_shade))),this.e_iframe=f_getElement("tcalIF"),b_ieFix&&!this.e_iframe&&(this.e_iframe=document.createElement("IFRAME"),this.e_iframe.style.filter="alpha(opacity=0)",this.e_iframe.id="tcalIF",this.e_iframe.src=this.a_tpl.imgpath+"pixel.gif",$(this.e_icon).offsetParent().append($(this.e_iframe))),f_tcalHideAll(),this.e_icon=f_getElement(this.s_iconId),this.f_update()&&(this.e_div.style.visibility="visible",this.e_shade.style.visibility="visible",this.e_iframe&&(this.e_iframe.style.visibility="visible"),this.e_icon.src=this.a_tpl.imgpath+"calendar-x-20px.png",this.e_icon.title="",this.b_visible=!0)}function f_tcalHide(a){if(a){var b=$(this.e_input);b.val(this.f_generDate(new Date(a))),b.change()}this.b_visible&&(this.e_iframe&&(this.e_iframe.style.visibility="hidden"),this.e_shade&&(this.e_shade.style.visibility="hidden"),this.e_div.style.visibility="hidden",this.e_icon=f_getElement(this.s_iconId),this.e_icon.src=this.a_tpl.imgpath+"calendar-20px.png",this.e_icon.title="",this.b_visible=!1,this.e_input.blur())}function f_tcalToggle(){return this.b_visible?this.f_hide():this.f_show()}function f_tcalUpdate(a){var b=this.a_cfg.today?this.f_parseDate(this.a_cfg.today):f_tcalResetTime(new Date),c=""==this.e_input.value?this.a_cfg.selected?this.f_parseDate(this.a_cfg.selected):b:this.f_parseDate(this.e_input.value);if(a?"number"==typeof a?a=f_tcalResetTime(new Date(a)):"string"==typeof a&&this.f_parseDate(a):a=c,!a)return!1;var d=new Date(a);d.setDate(1),d.setDate(1-(7+d.getDay()-this.a_tpl.weekstart)%7);for(var e,f='<table class="ctrl"><tbody><tr>'+(this.a_tpl.yearscroll?"<td"+this.f_relDate(a,-1,"y")+' title="Previous Year"><img src="'+this.a_tpl.imgpath+'prev_year.gif" /></td>':"")+"<td"+this.f_relDate(a,-1)+' title="Previous Month"><img src="'+this.a_tpl.imgpath+'prev_mon.gif" /></td><th>'+this.a_tpl.months[a.getMonth()]+" "+a.getFullYear()+"</th><td"+this.f_relDate(a,1)+' title="Next Month"><img src="'+this.a_tpl.imgpath+'next_mon.gif" /></td>'+(this.a_tpl.yearscroll?"<td"+this.f_relDate(a,1,"y")+' title="Next Year"><img src="'+this.a_tpl.imgpath+'next_year.gif" /></td></td>':"")+'</tr></tbody></table><table><tbody><tr class="wd">',g=0;g<7;g++)f+="<th>"+this.a_tpl.weekdays[(this.a_tpl.weekstart+g)%7]+"</th>";f+="</tr>";for(var h,i,j=new Date(d);j.getMonth()==a.getMonth()||j.getMonth()==d.getMonth();){f+="<tr>";for(var k=0;k<7;k++)for(e=[],h=j.getDate(),i=j.getMonth(),j.getMonth()!=a.getMonth()&&(e[e.length]="othermonth"),0!=j.getDay()&&6!=j.getDay()||(e[e.length]="weekend"),j.valueOf()==b.valueOf()&&(e[e.length]="today"),j.valueOf()==c.valueOf()&&(e[e.length]="selected"),j.valueOf()<b.valueOf()&&$("#tcalico_"+this.s_id).parents("tr.autopayRow").data("ismonthtomonth")?f+='<td onclick="return false;"'+(e.length?' class="'+e.join(" ")+' previous-date">':'class="previous-date">')+h+"</td>":f+="<td onclick=\"A_TCALS['"+this.s_id+"'].f_hide("+j.valueOf()+')"'+(e.length?' class="'+e.join(" ")+'">':">")+h+"</td>",j.setDate(++h);j.getDate()!=h&&j.getMonth()==i;)j.setHours(j.getHours+1),j=f_tcalResetTime(j);f+="</tr>"}f+="</tbody></table>",this.e_div.innerHTML=f;var l=this.e_div.offsetWidth,m=this.e_div.offsetHeight;$e_icon=$(this.e_icon);var n=$e_icon.position().top+$e_icon.outerHeight()+$e_icon.offsetParent().scrollTop(),o=$e_icon.position().left+$e_icon.outerWidth()+$e_icon.offsetParent().scrollLeft()-l;return o<0&&(o=0),this.e_div.style.left=o+"px",this.e_div.style.top=n+"px",this.e_shade.style.width=l+8+"px",this.e_shade.style.left=o-1+"px",this.e_shade.style.top=n-1+"px",this.e_shade.innerHTML=b_ieFix?'<table><tbody><tr><td rowspan="2" colspan="2" width="6"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td><td width="7" height="7" style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+this.a_tpl.imgpath+"shade_tr.png', sizingMethod='scale');\"><img src=\""+this.a_tpl.imgpath+'pixel.gif"></td></tr><tr><td height="'+(m-7)+'" style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+this.a_tpl.imgpath+"shade_mr.png', sizingMethod='scale');\"><img src=\""+this.a_tpl.imgpath+'pixel.gif"></td></tr><tr><td width="7" style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+this.a_tpl.imgpath+"shade_bl.png', sizingMethod='scale');\"><img src=\""+this.a_tpl.imgpath+'pixel.gif"></td><td style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+this.a_tpl.imgpath+'shade_bm.png\', sizingMethod=\'scale\');" height="7" align="left"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td><td style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+this.a_tpl.imgpath+"shade_br.png', sizingMethod='scale');\"><img src=\""+this.a_tpl.imgpath+'pixel.gif"></td></tr><tbody></table>':'<table><tbody><tr><td rowspan="2" width="6"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td><td rowspan="2"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td><td width="7" height="7"><img src="'+this.a_tpl.imgpath+'shade_tr.png"></td></tr><tr><td background="'+this.a_tpl.imgpath+'shade_mr.png" height="'+(m-7)+'"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td></tr><tr><td><img src="'+this.a_tpl.imgpath+'shade_bl.png"></td><td background="'+this.a_tpl.imgpath+'shade_bm.png" height="7" align="left"><img src="'+this.a_tpl.imgpath+'pixel.gif"></td><td><img src="'+this.a_tpl.imgpath+'shade_br.png"></td></tr><tbody></table>',this.e_iframe&&(this.e_iframe.style.left=o+"px",this.e_iframe.style.top=n+"px",this.e_iframe.style.width=l+6+"px",this.e_iframe.style.height=m+6+"px"),!0}function f_tcalRelDate(a,b,c){var c="y"==c?"FullYear":"Month",d=new Date(a);return d["set"+c](a["get"+c]()+b),d.getDate()!=a.getDate()&&d.setDate(0)," onclick=\"A_TCALS['"+this.s_id+"'].f_update("+d.valueOf()+')"'}function f_tcalHideAll(){for(var a=0;a<window.A_TCALSIDX.length;a++)window.A_TCALSIDX[a].f_hide()}function f_tcalResetTime(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a}var A_TCALDEF={months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Su","Mo","Tu","We","Th","Fr","Sa"],yearscroll:!0,weekstart:0,centyear:70,imgpath:contentUrl("/asp/images/cal/")};f_getElement=document.all?function(a){return document.all[a]}:function(a){return document.getElementById(a)},window.A_TCALSIDX&&(document.addEventListener&&window.addEventListener("scroll",f_tcalHideAll,!1),window.attachEvent&&window.attachEvent("onscroll",f_tcalHideAll));var s_userAgent=navigator.userAgent.toLowerCase(),re_webkit=/WebKit\/(\d+)/i,b_mac=-1!=s_userAgent.indexOf("mac"),b_ie5=-1!=s_userAgent.indexOf("msie 5"),b_ie6=-1!=s_userAgent.indexOf("msie 6")&&-1==s_userAgent.indexOf("opera"),b_ieFix=b_ie5||b_ie6,b_ieMac=b_mac&&b_ie5,b_safari=b_mac&&re_webkit.exec(s_userAgent)&&Number(RegExp.$1)<500;