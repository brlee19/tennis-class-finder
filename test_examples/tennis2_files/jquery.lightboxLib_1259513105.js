lightboxConfig={lbOpacity:.6,lbBackground:"444",lbdialog_defaultHeight:205,lbdialog_allowCloseByClickingLightbox:!1,lbdialog_css:{borderRadius:10,width:400,fontSize:14}};var ie6=navigator.appVersion.match(/MSIE 6\.0/),closeLBDialogOnEscapePress=function(a){27==a.keyCode&&hidelightbox()};$(function(){jQuery.fn.lightbox=function(a,b,c,d){var e=arguments.callee;$(this).addClass("lightbox_centralElement");var f=this.get(0);if($(f).children().hide(),c&&$("#lightbox").css({opacity:0,filter:"alpha(opacity=0)"}),d&&$("#lightbox").addClass("noClose"),e.doHide=function(a,b){if(a)$(e.centralElement).hide(),$("#lightbox").hide(),b&&b(),reinsertCentralElement();else{var c;if((c=$(e.centralElement).children().length)>0){var d=0;$(e.centralElement).children().fadeOut("",function(){++d==c&&$(e.centralElement).slideUp(100,function(){reinsertCentralElement(),$("#lightbox").fadeOut("fast",b?b():null)})})}else $(e.centralElement).slideUp("fast",function(){$("#lightbox").fadeOut("fast",b?b():null),reinsertCentralElement()})}},"lightbox"!=f.id){var g=$(f).clone(!0),h=document.createElement("em");$(f).before($(h)),h.id="markerNodeForReinsertion",$(f).remove(),f=document.body.insertBefore(g.get(0),document.body.childNodes[0]),d||$(f).find("button, .close").not(".noLBClose, [rel=noLBClose]").click(function(a){$("#lightbox").lightbox()}),"absolute"!=$(f).css("position")&&$(f).css("position","absolute"),10001!=$(f).css("zIndex")&&$(f).css("zIndex",10001),e.centralElement=f,$(f).centreElement()}if($("#lightbox").is(":hidden")){var i=function(){$(f).slideDown(150,function(){$(f).children(":not(:visible)").fadeIn()})};a?($("#lightbox").show(),i()):$("#lightbox").fadeIn("fast",i),b&&setTimeout(hidelightbox,1e3*b)}else e.doHide()},jQuery.fn.centreElement=function(a,b,c){void 0==a&&(a=!0),void 0==b&&(b=!0);var d=document.documentElement.scrollLeft||document.body.scrollLeft||0||window.pageXOffset,e=document.documentElement.scrollTop||document.body.scrollTop||0||window.pageYOffset;void 0==d&&(d=0),void 0==e&&(e=0);var f=this.get(0),g=parseInt(f.currentStyle?f.currentStyle.width:getComputedStyle(f,null).width);isNaN(g)&&($(f).css("width","300px"),g=300);var h=(self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2-g/2+d,i=parseInt(f.currentStyle?f.currentStyle.height:getComputedStyle(f,null).height);isNaN(i)&&($(f).css("height","auto"),i=300);var j=50+e;if(j-=parseInt(f.currentStyle?f.currentStyle.paddingTop:getComputedStyle(f,null).paddingTop),h-=parseInt(f.currentStyle?f.currentStyle.paddingLeft:getComputedStyle(f,null).paddingLeft),c){if(!(a&&!a||b&&!b))return[h,j];if(!a||a)return h;if(!b||b)return b}else a&&(f.style.left=h+"px"),b&&(f.style.top=j+"px")};var a=document.createElement("div");a.id="lightbox",$(a).click(function(){$(this).hasClass("noClose")||"lightboxdialog"==jQuery.fn.lightbox.centralElement.id&&!lightboxConfig.lbdialog_allowCloseByClickingLightbox||$(this).lightbox()}),$(document.body).prepend(a),$("#lightbox").css({opacity:lightboxConfig.lbOpacity,filter:"alpha(opacity="+100*lightboxConfig.lbOpacity+")",width:$(document).width(),height:$(document).height(),background:"#"+lightboxConfig.lbBackground,position:"fixed",left:0,top:0,zIndex:1e4,display:"none"})}),reinsertCentralElement=function(){var a=jQuery.fn.lightbox.centralElement;try{if(markerNodeForReinsertion=$("#markerNodeForReinsertion").get(0),"body"!=markerNodeForReinsertion.parentNode.tagName.toLowerCase()){var b=a;a.parentNode.removeChild(a),markerNodeForReinsertion.parentNode.insertBefore(b,markerNodeForReinsertion),markerNodeForReinsertion.parentNode.removeChild(markerNodeForReinsertion)}}catch(a){}},lbdialog=function(params){if("string"!=typeof params.content||params.okButton&&"function"!=typeof params.okButton.callback&&params.okButton.callback||params.cancelButton&&"function"!=typeof params.cancelButton.callback&&params.cancelButton.callback)return!1;0!=$("#lightboxdialog").length&&$("#lightboxdialog").remove();var lbMain=document.createElement("div"),lbHeader=document.createElement("div"),lbContent=document.createElement("div"),lbMessage=document.createElement("div"),lbButtons=document.createElement("div");with($(lbMain))attr("id","lightboxdialog"),"object"==typeof params.css&&$(lbMain).css(params.css),lightboxConfig.lbdialog_css&&css(lightboxConfig.lbdialog_css);$(lbMain).css({position:"absolute",height:lightboxConfig.lbdialog_defaultHeight}),$(lbMain).addClass("group"),$(lbContent).addClass("group"),$(lbMain).addClass("lb-main"),$(lbMessage).addClass("lb-message"),$(lbContent).addClass("lb-content"),$(lbContent).addClass(params.cancelButton&&params.OKButton?"lb-confirm":"lb-alert"),$(lbHeader).addClass("lb-header"),$(lbButtons).addClass("lb-buttons"),"string"==typeof params.headerclass&&$(lbHeader).addClass(params.headerclass),"string"==typeof params.buttonclass&&$(lbButtons).addClass(params.buttonclass),"string"==typeof params.contentclass&&$(lbContent).addClass(params.contentclass),"string"==typeof params.messageclass&&$(lbMessage).addClass(params.messageclass),"string"==typeof params.mainclass&&$(lbMain).addClass(params.mainclass),$("body").prepend(lbMain),$(lbMain).prepend(lbContent),$(lbMain).prepend(lbHeader);var fs=lightboxConfig.lbdialog_css.fontSize+"";fs.match(/^\d$/)||(fs+="px");var header,header=params.header;header=void 0==header?"":"<h4>"+header+"</h4>",$(lbHeader).html(header),$(lbContent).append(lbMessage),$(lbContent).append("<div style='clear: both'></div>"),$(lbContent).append(lbButtons);var content;for(content=params.content;content.indexOf("\n")>-1;)content=content.replace("\n","<br />");if(""!=content&&($(lbMessage).html("<p>"+content+"</p>"),fs&&$(lbMessage).css({"font-size":fs})),!params.autoDisappear){var buttons=["OK","cancel"];for(var e in buttons)if("OK"==buttons[e]||params.cancelButton){var but=document.createElement("button");if($(but).addClass("OK"==buttons[e]&&params.cancelButton&&params.OKButton?"lb-continue-button":"lb-standard-button"),params[buttons[e]+"Button"]){params[buttons[e]+"Button"].noLBClose&&$(but).addClass("noLBClose");var butText=params[buttons[e]+"Button"].text?params[buttons[e]+"Button"].text:buttons[e];params[buttons[e]+"Button"].callback&&$(but).click(params[buttons[e]+"Button"].callback)}else var butText=buttons[e];$(but).text(butText),lbButtons.appendChild(but),$(but).addClass("lb-button")}}$(lbMain).lightbox(!0,params.autoDisappear?params.autoDisappear:null,!!params.noLightbox||null);var confOnEnter=function(a){13==a.keyCode&&$(".lb-continue-button").click(),$(document).unbind("keyup",confOnEnter)};$(document).bind("keyup",confOnEnter),$(document).bind("keyup",closeLBDialogOnEscapePress)},hidelightbox=function(a,b){jQuery.fn.lightbox.doHide(a,b),$(document).unbind("keyup",closeLBDialogOnEscapePress)};